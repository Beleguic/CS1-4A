<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <title>{% block title %}{% endblock %}</title>
        <link rel="icon" href="/plombier.png" type="image/png">
        {% block stylesheets %}
            {{ encore_entry_link_tags('app') }}
        {% endblock %}
        {% block javascripts %}
                <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
            {{ encore_entry_script_tags('app') }}
            <script src="https://code.highcharts.com/highcharts.js"></script>
            <script src="https://code.highcharts.com/modules/exporting.js"></script>
            <script src="https://code.highcharts.com/modules/export-data.js"></script>
            <script>
                // Simple navigation detection for admin icon refresh
                window.addEventListener('pageshow', function(event) {
                    if (event.persisted && window.refreshIcons) {
                        // Page was restored from cache (back/forward navigation)
                        window.refreshIcons();
                    }
                });
            </script>
        {% endblock %}
    </head>
<body class="h-full bg-bgBody-400 dark:bg-bgBody-800 text-TextColor-400 dark:text-TextColor-800 font-sans">
    {% include '_composants/_sidebar.html.twig' with {'type': 'admin'} %}
    <div class="flex-1 sm:ml-64 relative">
        {% include '_composants/_header.html.twig' with {'type': 'admin', 'page_title': block('title')} %}
        <main class="min-h-screen">
            <div class="p-6 m-4 bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm rounded-2xl shadow-lg border border-white/20 dark:border-gray-700/50">
                {% for type, flashMessages in app.flashes %}
                    {% for message in flashMessages %}
                        <div class="rounded-lg p-4 mb-4 border-l-4 backdrop-blur-sm 
                                    {% if type == 'success' %}bg-green-50/90 dark:bg-green-900/20 border-l-green-500 text-green-800 dark:text-green-400
                                    {% elseif type == 'error' %}bg-red-50/90 dark:bg-red-900/20 border-l-red-500 text-red-800 dark:text-red-400
                                    {% elseif type == 'warning' %}bg-yellow-50/90 dark:bg-yellow-900/20 border-l-yellow-500 text-yellow-800 dark:text-yellow-400
                                    {% else %}bg-blue-50/90 dark:bg-blue-900/20 border-l-blue-500 text-blue-800 dark:text-blue-400{% endif %}">
                            <div class="flex items-center">
                                {% if type == 'success' %}
                                    {{ include('_composants/_lucide_icon.html.twig', { name: 'check-circle', class: 'mr-3 text-green-600 dark:text-green-400' }) }}
                                {% elseif type == 'error' %}
                                    {{ include('_composants/_lucide_icon.html.twig', { name: 'alert-circle', class: 'mr-3 text-red-600 dark:text-red-400' }) }}
                                {% elseif type == 'warning' %}
                                    {{ include('_composants/_lucide_icon.html.twig', { name: 'alert-triangle', class: 'mr-3 text-yellow-600 dark:text-yellow-400' }) }}
                                {% else %}
                                    {{ include('_composants/_lucide_icon.html.twig', { name: 'info', class: 'mr-3 text-blue-600 dark:text-blue-400' }) }}
                                {% endif %}
                                <span class="font-medium">{{ message|raw }}</span>
                            </div>
                        </div>
                    {% endfor %}
                {% endfor %}

                {% block body %}{% endblock %}
            </div>
        </main>
        {% include '_composants/_footer.html.twig' with {'type': 'admin'} %}
    </div>
</body>
</html>